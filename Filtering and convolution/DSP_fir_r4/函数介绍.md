```c
void DSP_fir_r4 (
    vector signed short *x,   
    signed short *h,       
    vector signed short  *r,
    int nh,
    int nr
)
```
**函数介绍**：Q15格式的fir滤波器
**计算**：r(n) = h(0)*x(n) + h(1)*x(n−1) + ... + h(nh−1)*x(n−nh+1)   where n = {0, 1, ... , nr−1}

**参数要求**：  

 *  nr >= 4; nr % 4 == 0 
 * nh >= 4; nh % 4 == 0 
 * r 16字对齐

**函数性能：**（单位：cycle）

|  NR   |  NH   | optC  | vc_cycle | sa_cycle | asm_cycle |
| :---: | :---: | :---: | :------: | :------: | :-------: |
|   4   |   4   |  50   |    54    |    16    |    13     |
|   8   |   4   |  66   |    52    |    17    |    14     |
|  12   |   4   |  93   |    52    |    17    |    14     |
|  16   |   4   |  90   |    52    |    17    |    15     |
|  20   |   4   |  117  |    52    |    19    |    17     |
|  24   |   4   |  114  |    52    |    19    |    17     |
|  28   |   4   |  141  |    52    |    19    |    17     |
|  32   |   4   |  138  |    53    |    20    |    17     |
|  36   |   4   |  165  |    56    |    21    |    19     |
|  40   |   4   |  162  |    55    |    22    |    19     |
|  44   |   4   |  189  |    56    |    22    |    19     |
|  48   |   4   |  186  |    56    |    22    |    19     |
|  52   |   4   |  213  |    58    |    23    |    21     |
|  56   |   4   |  210  |    58    |    23    |    21     |
|  60   |   4   |  237  |    59    |    24    |    21     |
|  64   |   4   |  234  |    59    |    23    |    21     |
|  68   |   4   |  261  |    63    |    25    |    24     |
|  72   |   4   |  258  |    62    |    26    |    24     |
|  76   |   4   |  285  |    62    |    26    |    24     |
|  80   |   4   |  282  |    63    |    25    |    24     |
|  84   |   4   |  309  |    65    |    27    |    25     |
|  88   |   4   |  306  |    65    |    27    |    26     |
|  92   |   4   |  333  |    65    |    28    |    25     |
|  96   |   4   |  330  |    65    |    27    |    25     |
|  100  |   4   |  357  |    70    |    29    |    28     |
|  104  |   4   |  354  |    69    |    29    |    28     |
|  108  |   4   |  381  |    69    |    30    |    28     |
|  112  |   4   |  378  |    70    |    29    |    28     |
|  116  |   4   |  405  |    71    |    32    |    30     |
|  120  |   4   |  402  |    72    |    31    |    30     |
|  124  |   4   |  429  |    72    |    31    |    29     |
|  128  |   4   |  426  |    72    |    31    |    29     |
|   4   |   8   |  50   |    74    |    20    |    18     |
|   8   |   8   |  66   |    75    |    20    |    18     |
|  12   |   8   |  93   |    74    |    20    |    18     |
|  16   |   8   |  90   |    75    |    20    |    18     |
|  20   |   8   |  117  |    79    |    24    |    22     |
|  24   |   8   |  114  |    79    |    23    |    22     |
|  28   |   8   |  141  |    79    |    23    |    22     |
|  32   |   8   |  138  |    79    |    24    |    22     |
|  36   |   8   |  165  |    86    |    28    |    26     |
|  40   |   8   |  162  |    87    |    27    |    26     |
|  44   |   8   |  189  |    87    |    28    |    25     |
|  48   |   8   |  186  |    87    |    28    |    25     |
|  52   |   8   |  213  |    92    |    31    |    29     |
|  56   |   8   |  210  |    92    |    31    |    29     |
|  60   |   8   |  237  |    92    |    31    |    30     |
|  64   |   8   |  234  |    92    |    31    |    29     |
|  68   |   8   |  261  |    98    |    35    |    33     |
|  72   |   8   |  258  |    99    |    35    |    33     |
|  76   |   8   |  285  |    98    |    35    |    33     |
|  80   |   8   |  282  |    99    |    35    |    33     |
|  84   |   8   |  309  |   104    |    38    |    37     |
|  88   |   8   |  306  |   104    |    37    |    37     |
|  92   |   8   |  333  |   103    |    38    |    36     |
|  96   |   8   |  330  |   103    |    37    |    37     |
|  100  |   8   |  357  |   109    |    42    |    41     |
|  104  |   8   |  354  |   109    |    42    |    40     |
|  108  |   8   |  381  |   110    |    42    |    40     |
|  112  |   8   |  378  |   110    |    41    |    40     |
|  116  |   8   |  405  |   115    |    45    |    44     |
|  120  |   8   |  402  |   115    |    44    |    44     |
|  124  |   8   |  429  |   115    |    44    |    43     |
|  128  |   8   |  426  |   114    |    45    |    43     |
|   4   |  12   |  53   |   100    |    23    |    20     |
|   8   |  12   |  70   |   100    |    23    |    21     |
|  12   |  12   |  100  |   100    |    23    |    21     |
|  16   |  12   |  98   |   101    |    23    |    21     |
|  20   |  12   |  128  |   108    |    28    |    26     |
|  24   |  12   |  126  |   107    |    29    |    26     |
|  28   |  12   |  156  |   108    |    28    |    26     |
|  32   |  12   |  154  |   107    |    28    |    26     |
|  36   |  12   |  184  |   116    |    34    |    31     |
|  40   |  12   |  182  |   115    |    34    |    32     |
|  44   |  12   |  212  |   116    |    33    |    32     |
|  48   |  12   |  210  |   116    |    34    |    32     |
|  52   |  12   |  240  |   123    |    39    |    37     |
|  56   |  12   |  238  |   124    |    38    |    37     |
|  60   |  12   |  268  |   123    |    39    |    37     |
|  64   |  12   |  266  |   124    |    39    |    37     |
|  68   |  12   |  296  |   132    |    44    |    43     |
|  72   |  12   |  294  |   132    |    44    |    43     |
|  76   |  12   |  324  |   133    |    44    |    43     |
|  80   |  12   |  322  |   133    |    44    |    43     |
|  84   |  12   |  352  |   139    |    49    |    47     |
|  88   |  12   |  350  |   140    |    49    |    47     |
|  92   |  12   |  380  |   139    |    49    |    48     |
|  96   |  12   |  378  |   140    |    49    |    48     |
|  100  |  12   |  408  |   149    |    54    |    53     |
|  104  |  12   |  406  |   149    |    54    |    53     |
|  108  |  12   |  436  |   149    |    54    |    54     |
|  112  |  12   |  434  |   149    |    54    |    53     |
|  116  |  12   |  464  |   155    |    59    |    58     |
|  120  |  12   |  462  |   156    |    59    |    58     |
|  124  |  12   |  492  |   156    |    58    |    58     |
|  128  |  12   |  490  |   156    |    58    |    58     |
|   4   |  16   |  56   |   125    |    26    |    23     |
|   8   |  16   |  74   |   124    |    26    |    23     |
|  12   |  16   |  107  |   125    |    26    |    23     |
|  16   |  16   |  106  |   125    |    26    |    23     |
|  20   |  16   |  139  |   134    |    33    |    30     |
|  24   |  16   |  138  |   134    |    33    |    30     |
|  28   |  16   |  171  |   135    |    33    |    31     |
|  32   |  16   |  170  |   134    |    33    |    30     |
|  36   |  16   |  203  |   145    |    40    |    38     |
|  40   |  16   |  202  |   145    |    40    |    37     |
|  44   |  16   |  235  |   145    |    40    |    37     |
|  48   |  16   |  234  |   144    |    40    |    38     |
|  52   |  16   |  267  |   155    |    46    |    45     |
|  56   |  16   |  266  |   155    |    46    |    45     |
|  60   |  16   |  299  |   154    |    46    |    45     |
|  64   |  16   |  298  |   155    |    46    |    45     |
|  68   |  16   |  331  |   167    |    53    |    52     |
|  72   |  16   |  330  |   166    |    53    |    52     |
|  76   |  16   |  363  |   166    |    53    |    52     |
|  80   |  16   |  362  |   166    |    53    |    52     |
|  84   |  16   |  395  |   176    |    59    |    59     |
|  88   |  16   |  394  |   175    |    59    |    59     |
|  92   |  16   |  427  |   175    |    59    |    58     |
|  96   |  16   |  426  |   176    |    59    |    58     |
|  100  |  16   |  459  |   187    |    66    |    65     |
|  104  |  16   |  458  |   187    |    66    |    65     |
|  108  |  16   |  491  |   187    |    66    |    65     |
|  112  |  16   |  490  |   187    |    67    |    66     |
|  116  |  16   |  523  |   197    |    72    |    73     |
|  120  |  16   |  522  |   196    |    72    |    73     |
|  124  |  16   |  555  |   197    |    73    |    72     |
|  128  |  16   |  554  |   197    |    73    |    72     |
|   4   |  20   |  59   |   150    |    29    |    27     |
|   8   |  20   |  78   |   149    |    29    |    27     |
|  12   |  20   |  114  |   149    |    29    |    26     |
|  16   |  20   |  114  |   149    |    29    |    26     |
|  20   |  20   |  150  |   161    |    37    |    35     |
|  24   |  20   |  150  |   161    |    37    |    35     |
|  28   |  20   |  186  |   161    |    37    |    35     |
|  32   |  20   |  186  |   161    |    37    |    35     |
|  36   |  20   |  222  |   174    |    45    |    44     |
|  40   |  20   |  222  |   174    |    46    |    44     |
|  44   |  20   |  258  |   174    |    46    |    43     |
|  48   |  20   |  258  |   174    |    45    |    44     |
|  52   |  20   |  294  |   186    |    54    |    53     |
|  56   |  20   |  294  |   187    |    53    |    53     |
|  60   |  20   |  330  |   186    |    53    |    52     |
|  64   |  20   |  330  |   186    |    53    |    53     |
|  68   |  20   |  366  |   200    |    62    |    61     |
|  72   |  20   |  366  |   200    |    62    |    62     |
|  76   |  20   |  402  |   200    |    62    |    62     |
|  80   |  20   |  402  |   200    |    62    |    62     |
|  84   |  20   |  438  |   212    |    70    |    69     |
|  88   |  20   |  438  |   212    |    70    |    70     |
|  92   |  20   |  474  |   212    |    70    |    70     |
|  96   |  20   |  474  |   211    |    70    |    69     |
|  100  |  20   |  510  |   226    |    78    |    78     |
|  104  |  20   |  510  |   225    |    79    |    78     |
|  108  |  20   |  546  |   226    |    79    |    78     |
|  112  |  20   |  546  |   225    |    78    |    78     |
|  116  |  20   |  582  |   237    |    86    |    87     |
|  120  |  20   |  582  |   238    |    87    |    87     |
|  124  |  20   |  618  |   237    |    87    |    87     |
|  128  |  20   |  618  |   238    |    86    |    87     |
|   4   |  24   |  62   |   174    |    32    |    29     |
|   8   |  24   |  82   |   174    |    32    |    30     |
|  12   |  24   |  121  |   174    |    31    |    29     |
|  16   |  24   |  122  |   173    |    32    |    29     |
|  20   |  24   |  161  |   188    |    41    |    39     |
|  24   |  24   |  162  |   188    |    42    |    39     |
|  28   |  24   |  201  |   188    |    42    |    39     |
|  32   |  24   |  202  |   187    |    41    |    39     |
|  36   |  24   |  241  |   203    |    51    |    50     |
|  40   |  24   |  242  |   203    |    52    |    50     |
|  44   |  24   |  281  |   203    |    51    |    50     |
|  48   |  24   |  282  |   203    |    51    |    50     |
|  52   |  24   |  321  |   218    |    61    |    60     |
|  56   |  24   |  322  |   217    |    61    |    61     |
|  60   |  24   |  361  |   217    |    61    |    61     |
|  64   |  24   |  362  |   217    |    61    |    61     |
|  68   |  24   |  401  |   234    |    71    |    71     |
|  72   |  24   |  402  |   233    |    72    |    71     |
|  76   |  24   |  441  |   234    |    71    |    71     |
|  80   |  24   |  442  |   233    |    71    |    72     |
|  84   |  24   |  481  |   248    |    81    |    81     |
|  88   |  24   |  482  |   248    |    81    |    81     |
|  92   |  24   |  521  |   248    |    80    |    80     |
|  96   |  24   |  522  |   248    |    80    |    81     |
|  100  |  24   |  561  |   264    |    91    |    91     |
|  104  |  24   |  562  |   264    |    91    |    91     |
|  108  |  24   |  601  |   264    |    91    |    91     |
|  112  |  24   |  602  |   264    |    91    |    91     |
|  116  |  24   |  641  |   278    |   100    |    101    |
|  120  |  24   |  642  |   278    |   100    |    101    |
|  124  |  24   |  681  |   279    |   100    |    101    |
|  128  |  24   |  682  |   278    |   100    |    101    |
|   4   |  28   |  65   |   198    |    35    |    32     |
|   8   |  28   |  86   |   198    |    35    |    32     |
|  12   |  28   |  128  |   198    |    34    |    32     |
|  16   |  28   |  130  |   198    |    35    |    32     |
|  20   |  28   |  172  |   215    |    47    |    44     |
|  24   |  28   |  174  |   215    |    46    |    44     |
|  28   |  28   |  216  |   214    |    47    |    44     |
|  32   |  28   |  218  |   215    |    46    |    43     |
|  36   |  28   |  260  |   232    |    57    |    55     |
|  40   |  28   |  262  |   232    |    58    |    56     |
|  44   |  28   |  304  |   232    |    57    |    56     |
|  48   |  28   |  306  |   232    |    58    |    56     |
|  52   |  28   |  348  |   250    |    69    |    68     |
|  56   |  28   |  350  |   249    |    69    |    69     |
|  60   |  28   |  392  |   249    |    68    |    68     |
|  64   |  28   |  394  |   250    |    68    |    68     |
|  68   |  28   |  436  |   268    |    80    |    81     |
|  72   |  28   |  438  |   267    |    80    |    81     |
|  76   |  28   |  480  |   268    |    80    |    81     |
|  80   |  28   |  482  |   268    |    80    |    80     |
|  84   |  28   |  524  |   284    |    92    |    92     |
|  88   |  28   |  526  |   285    |    91    |    92     |
|  92   |  28   |  568  |   284    |    91    |    92     |
|  96   |  28   |  570  |   284    |    91    |    92     |
|  100  |  28   |  612  |   303    |   103    |    104    |
|  104  |  28   |  614  |   302    |   103    |    103    |
|  108  |  28   |  656  |   302    |   103    |    104    |
|  112  |  28   |  658  |   302    |   103    |    104    |
|  116  |  28   |  700  |   319    |   114    |    116    |
|  120  |  28   |  702  |   319    |   114    |    116    |
|  124  |  28   |  744  |   319    |   114    |    116    |
|  128  |  28   |  746  |   319    |   114    |    115    |
|   4   |  32   |  68   |   222    |    37    |    34     |
|   8   |  32   |  90   |   222    |    38    |    35     |
|  12   |  32   |  135  |   222    |    37    |    34     |
|  16   |  32   |  138  |   222    |    37    |    35     |
|  20   |  32   |  183  |   241    |    50    |    48     |
|  24   |  32   |  186  |   241    |    51    |    48     |
|  28   |  32   |  231  |   241    |    51    |    48     |
|  32   |  32   |  234  |   241    |    50    |    48     |
|  36   |  32   |  279  |   261    |    63    |    63     |
|  40   |  32   |  282  |   261    |    64    |    63     |
|  44   |  32   |  327  |   261    |    64    |    63     |
|  48   |  32   |  330  |   261    |    64    |    62     |
|  52   |  32   |  375  |   280    |    76    |    76     |
|  56   |  32   |  378  |   281    |    76    |    76     |
|  60   |  32   |  423  |   281    |    76    |    76     |
|  64   |  32   |  426  |   281    |    76    |    76     |
|  68   |  32   |  471  |   302    |    89    |    91     |
|  72   |  32   |  474  |   301    |    89    |    90     |
|  76   |  32   |  519  |   301    |    89    |    90     |
|  80   |  32   |  522  |   301    |    89    |    90     |
|  84   |  32   |  567  |   320    |   102    |    103    |
|  88   |  32   |  570  |   320    |   102    |    103    |
|  92   |  32   |  615  |   321    |   102    |    103    |
|  96   |  32   |  618  |   321    |   102    |    103    |
|  100  |  32   |  663  |   341    |   115    |    117    |
|  104  |  32   |  666  |   341    |   116    |    116    |
|  108  |  32   |  711  |   341    |   115    |    116    |
|  112  |  32   |  714  |   341    |   116    |    116    |
|  116  |  32   |  759  |   360    |   127    |    130    |
|  120  |  32   |  762  |   360    |   128    |    130    |
|  124  |  32   |  807  |   360    |   128    |    130    |
|  128  |  32   |  810  |   361    |   127    |    130    |

*说明：optC为ti优化性能，vc为向量C，sa为线性汇编，asm为手写汇编*

*以下图表数据来源于上表*
<img src="result_image\DSP_fir_r4_cycle.png">

<img src="result_image\DSP_fir_r4_ratio.png">


**额外说明：** vectorC与手写汇编的最终结果与性能均以v2为准